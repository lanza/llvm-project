// RUN: gatorade %s -o - -cir-cross-library-import -inline | FileCheck %s

!s32i = !cir.int<s, 32>
module {
  cir.library @a {
    cir.func jni no_proto @jniA() -> !s32i {
      %0 = cir.call @funcB1() : () -> !s32i
      %1 = cir.call @funcB2() : () -> !s32i
      %2 = cir.binop(add, %0, %1) : !s32i
      cir.return %2 : !s32i
    }
    cir.func no_proto private @funcB1(...) -> !s32i
    cir.func no_proto private @funcB2(...) -> !s32i
  }
  cir.library @b {
    cir.func jni no_proto @jniB() -> !s32i {
      %0 = cir.call @funcB2() : () -> !s32i
      %1 = cir.call @funcB3() : () -> !s32i
      %2 = cir.binop(add, %0, %1) : !s32i
      cir.return %2 : !s32i
    }
    cir.func no_proto @funcB1() -> !s32i {
      %0 = cir.const(#cir.int<5> : !s32i) : !s32i
      cir.return %0 : !s32i
    }
    cir.func no_proto @funcB2() -> !s32i {
      %0 = cir.const(#cir.int<5> : !s32i) : !s32i
      cir.return %0 : !s32i
    }
    cir.func no_proto @funcB3() -> !s32i {
      %0 = cir.call @funcB2() : () -> !s32i
      cir.return %0 : !s32i
    }
  }
  cir.library @c {
    cir.func no_proto private @funcB1(...) -> !s32i
  }
}

//      CHECK: !s32i = !cir.int<s, 32>
// CHECK-NEXT: module {
// CHECK-NEXT:   cir.library @a {
// CHECK-NEXT:     cir.func no_proto cir_private @funcB1() -> !s32i {
// CHECK-NEXT:       %0 = cir.const(#cir.int<5> : !s32i) : !s32i
// CHECK-NEXT:       cir.return %0 : !s32i
// CHECK-NEXT:     }
// CHECK-NEXT:     cir.func jni no_proto @jniA() -> !s32i {
// CHECK-NEXT:       %0 = cir.const(#cir.int<5> : !s32i) : !s32i
// CHECK-NEXT:       %1 = cir.call @funcB2() : () -> !s32i
// CHECK-NEXT:       %2 = cir.binop(add, %0, %1) : !s32i
// CHECK-NEXT:       cir.return %2 : !s32i
// CHECK-NEXT:     }
// CHECK-NEXT:     cir.func no_proto private @funcB2(...) -> !s32i
// CHECK-NEXT:   }
// CHECK-NEXT:   cir.library @b {
// CHECK-NEXT:     cir.func jni no_proto @jniB() -> !s32i {
// CHECK-NEXT:       %0 = cir.const(#cir.int<5> : !s32i) : !s32i
// CHECK-NEXT:       %1 = cir.binop(add, %0, %0) : !s32i
// CHECK-NEXT:       cir.return %1 : !s32i
// CHECK-NEXT:     }
// CHECK-NEXT:     cir.func no_proto cir_private @funcB1() -> !s32i {
// CHECK-NEXT:       %0 = cir.const(#cir.int<5> : !s32i) : !s32i
// CHECK-NEXT:       cir.return %0 : !s32i
// CHECK-NEXT:     }
// CHECK-NEXT:     cir.func no_proto @funcB2() -> !s32i {
// CHECK-NEXT:       %0 = cir.const(#cir.int<5> : !s32i) : !s32i
// CHECK-NEXT:       cir.return %0 : !s32i
// CHECK-NEXT:     }
// CHECK-NEXT:     cir.func no_proto cir_private @funcB3() -> !s32i {
// CHECK-NEXT:       %0 = cir.const(#cir.int<5> : !s32i) : !s32i
// CHECK-NEXT:       cir.return %0 : !s32i
// CHECK-NEXT:     }
// CHECK-NEXT:   }
// CHECK-NEXT:   cir.library @c {
// CHECK-NEXT:     cir.func no_proto private @funcB1(...) -> !s32i
// CHECK-NEXT:   }
// CHECK-NEXT: }

